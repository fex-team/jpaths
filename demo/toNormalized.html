<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>jpaths</title>
    <style stylesheet="text/css">
        svg {
            width: 500px;
            height: 500px;
            border: 1px solid #ccc;
        }
        svg path {
            position: relative;
            fill: none;
            stroke-width: 2px;
        }
        svg path:nth-child(odd) {
            stroke: red;
        }
        svg path:nth-child(even){
            stroke: yellow;
        }
        svg path:first-child {
            stroke: #ccc;
            stroke-width: 6px;
        }
    </style>
</head>
<body>
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" id="svg">

</svg>   
</body>
<script src="../lib/require.js"></script>
<script>

define('start', function(require) {

    var jpaths = require('../src/jpaths');
    var path;
    var svg = document.getElementById('svg');

    function init(pathdata) {
        var obj = document.createElementNS('http://www.w3.org/2000/svg', 'path');
        var initpath;

        path = jpaths(pathdata);//创建jpaths对象

        initpath = path.toString('%n');//获取jpaths对象的path数据
        obj.setAttribute('d', initpath);
        svg.appendChild(obj);//测试初始时的path数据

        console.log('');
        console.log('测试的路径为：');
        console.log(initpath);
    }

    function test(pathdata) {
        init(pathdata);
        var subs = path.subPathes();
        var subs1 = path.toNormalized().subPathes();
        var n = subs.length;

        subs.forEach(function(sub, i) {
            var obj = document.createElementNS('http://www.w3.org/2000/svg', 'path');

            obj.setAttribute('d', sub.pathString);
            svg.appendChild(obj);
        });

        setTimeout(function() {
            while(n-- > 0) {
                svg.removeChild(svg.lastChild);
            }
        }, 1200);

        setTimeout(function() {
            subs1.forEach(function(sub, i) {
                var obj = document.createElementNS('http://www.w3.org/2000/svg', 'path');

                obj.setAttribute('d', sub.pathString);
                svg.appendChild(obj);
            });
        }, 2400);

        console.log('');
        console.log('规范化后的路径为：');
        console.log(path.toNormalized().toString('%n'));
    }

    test("M50,50v50h70c80,200,150,200,100,10q50 60 80 70t80,90");
    window.path = path;
    window.svg = svg;
});

require(['start'], function() {
    
});
</script>
</html>